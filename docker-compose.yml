version: '1.0'
services:
    web:
        container_name: web
        restart: always
        image: iamthienthanh/gooyi-web
        ports:
          - 80:3000

    postgres:
        container_name: postgres
        restart: always
        image: postgis/postgis
        ports:
          - 5432:5432
        volumes:
          - postgres:/var/lib/postgresql/data
        environment:
          - POSTGRES_USER=gooyi
          - POSTGRES_PASSWORD=gooyi
          - POSTGERS_DB=gooyi
          - POSTGRES_HOST_AUTH_METHOD=scram-sha-256
          - POSTGRES_INITDB_ARGS=--auth-host=scram-sha-256

    gooyi:
        container_name: gooyi
        restart: always
        image: iamthienthanh/gooyi
        ports:
          - 8000:8000
        volumes:
          - logs:/app/logs
          - public:/app/public
        depends_on:
          - postgres
        environment:
          - PORT = 8000
          - host = "gooyi.de"
          - MAIL_HOST = 'info@gooyi.de'
          - PASS_MAIL_HOST = 'fdjdPPT3p4X4Xk&'
          - APP_SCHEMA = "exp://192.168.1.9:19000"
          - JWT_SECRET_KEY = "abcdefghijklmnopqrstuvwxyz"
          - DATABASE_URL="postgresql://gooyi:gooyi@153.92.223.235:5432/gooyi?schema=public"
    redis:
        container_name: redis
        image: redis
        restart: always
        volumes:
          - cache:/data
        ports:
          - 6379:6379

volumes:
  postgres:
  logs:
  public:
  cache: